<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§Ù†Ø¶Ù… ÙƒÙ…Ø³Ø§Ø¹Ø¯ Ø³ÙŠØ§Ø­ÙŠ</title>
<link rel="stylesheet" href="style.css">
<script src="data/data_config.js"></script>
<style>
.files-upload-section {
    border: 2px dashed var(--gold);
    padding: 25px;
    border-radius: 10px;
    margin-top: 30px;
    background-color: #2a2a2a;
}
.file-upload-info { color: #ccc; font-size: 0.9em; margin-bottom: 15px; }
.file-upload-info strong { color: var(--gold); }
.alert-warning {
    background-color: #5d4a0f;
    color: var(--yellow-warning);
    padding: 8px;
    border-radius: 5px;
    margin-top: 5px;
    font-size: 0.9em;
}
.form-group input[type="file"] {
    padding: 12px;
    line-height: normal;
    margin-bottom: 10px;
}
#message-box {
    padding:15px; 
    margin-top:20px; 
    text-align:center; 
    display:none;
    border-radius:5px;
    transition: all 0.3s ease;
}
</style>
</head>
<body>
<div class="header-controls">
    <a href="index.html" class="btn-back">ğŸ”™ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
    <a href="inquiry.html" class="btn-back" style="margin-right: 10px;">ğŸ” Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø¹Ù† Ø·Ù„Ø¨ Ø³Ø§Ø¨Ù‚</a>
</div>

<div class="container" style="max-width:600px;">
<h1>Ø§Ù†Ø¶Ù… Ø¥Ù„ÙŠÙ†Ø§ ÙƒÙ€ Ù…Ø³Ø§Ø¹Ø¯ Ø³ÙŠØ§Ø­ÙŠ ğŸ¤</h1>
<p>Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù…Ù„Ø¡ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø±Ø© Ø£Ø¯Ù†Ø§Ù‡ Ø¨Ø¹Ù†Ø§ÙŠØ© ÙˆØ±ÙØ¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.</p>

<form id="applicationForm">
<div class="form-group">
<label for="fullName">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„:</label>
<input type="text" id="fullName" required>
</div>

<div class="form-group">
<label for="phoneNumber">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:</label>
<input type="tel" id="phoneNumber" placeholder="Ù…Ø«Ø§Ù„: 97150xxxxxxx" required>
</div>

<div class="form-group">
<label for="address">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</label>
<input type="text" id="address" required>
</div>

<div class="form-group">
<label for="roleSelect">Ø§Ù„ÙˆØ¸ÙŠÙØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:</label>
<select id="roleSelect" onchange="toggleFileFields()" required>
<option value="">-- Ø§Ø®ØªØ± Ø§Ù„ÙˆØ¸ÙŠÙØ© --</option>
<option value="GUIDE">Ù…Ø±Ø´Ø¯ Ø³ÙŠØ§Ø­ÙŠ</option>
<option value="COMPANION">Ù…Ø±Ø§ÙÙ‚ Ù„Ø°ÙˆÙŠ Ø§Ù„Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª Ø§Ù„Ø®Ø§ØµØ©</option>
<option value="DRIVER">Ø³Ø§Ø¦Ù‚ Ù†Ù‚Ù„ Ø®Ø§Øµ</option>

</select>
</div>

<div id="fileUploadSection" class="files-upload-section">
<h2>ğŸ“‘ Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</h2>

<!-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± ØªØ­Øª Ø§Ù„Ù…Ù„ÙØ§Øª -->
<div id="message-box"></div>

<div id="commonFiles" style="display:none;">
<p class="file-upload-info"><strong>Ù…Ø·Ù„ÙˆØ¨ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¯ÙˆØ§Ø±:</strong></p>
<div class="form-group">
<label for="idFront">ğŸªª Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„ÙˆØ·Ù†ÙŠØ© (ÙˆØ¬Ù‡) ğŸ“‚:</label>
<input type="file" id="idFront" accept="image/*,application/pdf">
</div>
<div class="form-group">
<label for="idBack">ğŸªª Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„ÙˆØ·Ù†ÙŠØ© (Ø¸Ù‡Ø±) ğŸ“‚:</label>
<input type="file" id="idBack" accept="image/*,application/pdf">
</div>
<div class="form-group">
<label for="cv">ğŸ“„ Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ© (CV) - ÙŠÙ…ÙƒÙ† Ø±ÙØ¹ Ø¹Ø¯Ø© ØµÙˆØ± ğŸ“‚:</label>
<input type="file" id="cv" accept="image/*,application/pdf" multiple>
<div class="alert-warning">ÙŠØ±Ø¬Ù‰ Ø¥Ø±Ø³Ø§Ù„ ØµÙˆØ± ÙÙ‚Ø· Ù„Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©.</div>
</div>
</div>

<div id="guideFiles" style="display:none;">
<p class="file-upload-info"><strong>Ø®Ø§Øµ Ø¨Ø§Ù„Ù…Ø±Ø´Ø¯ Ø§Ù„Ø³ÙŠØ§Ø­ÙŠ:</strong></p>
<div class="form-group">
<label for="licenseFront">ğŸš— Ø§Ù„Ø±Ø®ØµØ© Ø§Ù„Ø³ÙŠØ§Ø­ÙŠØ© (ÙˆØ¬Ù‡) ğŸ“‚:</label>
<input type="file" id="licenseFront" accept="image/*,application/pdf">
</div>
<div class="form-group">
<label for="licenseBack">ğŸš— Ø§Ù„Ø±Ø®ØµØ© Ø§Ù„Ø³ÙŠØ§Ø­ÙŠØ© (Ø¸Ù‡Ø±) ğŸ“‚:</label>
<input type="file" id="licenseBack" accept="image/*,application/pdf">
</div>
</div>

<div id="companionFiles" style="display:none;">
<p class="file-upload-info"><strong>Ø®Ø§Øµ Ø¨Ø§Ù„Ù…Ø±Ø§ÙÙ‚ Ù„Ø°ÙˆÙŠ Ø§Ù„Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª Ø§Ù„Ø®Ø§ØµØ©:</strong></p>
<div class="form-group">
<label for="companionCard">ğŸ« ÙƒØ§Ø±Ù†ÙŠÙ‡ Ø³Ø§Ø¨Ù‚ (Ø¥Ù† ÙˆØ¬Ø¯) - Ø§Ø®ØªÙŠØ§Ø±ÙŠ ğŸ“‚:</label>
<input type="file" id="companionCard" accept="image/*,application/pdf">
</div>
</div>

<div id="driverFiles" style="display:none;">
<p class="file-upload-info"><strong>Ø®Ø§Øµ Ø¨Ø§Ù„Ø³Ø§Ø¦Ù‚ Ù†Ù‚Ù„ Ø®Ø§Øµ:</strong></p>
<div class="form-group">
<label for="driverLicenseFront">ğŸš— Ø±Ø®ØµØ© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© Ø§Ù„Ø®Ø§ØµØ© (ÙˆØ¬Ù‡) ğŸ“‚:</label>
<input type="file" id="driverLicenseFront" accept="image/*,application/pdf">
</div>
<div class="form-group">
<label for="driverLicenseBack">ğŸš— Ø±Ø®ØµØ© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© Ø§Ù„Ø®Ø§ØµØ© (Ø¸Ù‡Ø±) ğŸ“‚:</label>
<input type="file" id="driverLicenseBack" accept="image/*,application/pdf">
</div>
</div>

<div id="chefFiles" style="display:none;">
<p class="file-upload-info"><strong>Ø®Ø§Øµ Ø¨Ø§Ù„Ø·Ø¨Ø§Ø®:</strong></p>
<div class="form-group">
<label for="chefCert">ğŸ“œ Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ø·Ø¨Ø§Ø® ğŸ“‚:</label>
<input type="file" id="chefCert" accept="image/*,application/pdf">
</div>
</div>

</div> <!-- Ù†Ù‡Ø§ÙŠØ© fileUploadSection -->

<button type="submit" class="btn-submit" style="width:100%; margin-top:30px;">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
</form>
</div>

<script>
// Ø³ÙƒØ±ÙŠØ¨Øª ÙƒÙ…Ø§ Ù‡Ùˆ Ø¨Ø¯ÙˆÙ† ØªØ¹Ø¯ÙŠÙ„
function fileToDataURL(file){return new Promise((resolve,reject)=>{if(!file){resolve(null);return;}const reader=new FileReader();reader.onload=()=>resolve(reader.result);reader.onerror=error=>reject(error);reader.readAsDataURL(file);});}
function generateApplicationId(){return Math.floor(10000+Math.random()*90000).toString();}
function saveFormState(){sessionStorage.setItem('jobAppFullName',document.getElementById('fullName').value);sessionStorage.setItem('jobAppPhoneNumber',document.getElementById('phoneNumber').value);sessionStorage.setItem('jobAppAddress',document.getElementById('address').value);sessionStorage.setItem('jobAppRole',document.getElementById('roleSelect').value);}
function loadFormState(){document.getElementById('fullName').value=sessionStorage.getItem('jobAppFullName')||'';document.getElementById('phoneNumber').value=sessionStorage.getItem('jobAppPhoneNumber')||'';document.getElementById('address').value=sessionStorage.getItem('jobAppAddress')||'';document.getElementById('roleSelect').value=sessionStorage.getItem('jobAppRole')||'';}
function toggleFileFields(){saveFormState();const roleKey=document.getElementById('roleSelect').value;const roleSpecificSections={'GUIDE':document.getElementById('guideFiles'),'COMPANION':document.getElementById('companionFiles'),'DRIVER':document.getElementById('driverFiles'),'CHEF':document.getElementById('chefFiles')};document.getElementById('commonFiles').style.display=roleKey?'block':'none';Object.values(roleSpecificSections).forEach(el=>el.style.display='none');if(roleKey==='GUIDE'){document.getElementById('licenseFront').required=true;document.getElementById('licenseBack').required=true;}if(roleKey==='COMPANION'){document.getElementById('companionCard').required=false;}if(roleKey==='DRIVER'){document.getElementById('driverLicenseFront').required=true;document.getElementById('driverLicenseBack').required=true;}if(roleKey==='CHEF'){document.getElementById('chefCert').required=true;}const selectedSection=roleSpecificSections[roleKey];if(selectedSection) selectedSection.style.display='block';document.querySelectorAll('#fileUploadSection input[type="file"]').forEach(input=>{input.required=input.parentElement.parentElement.style.display!=='none'&&input.hasAttribute('required');});}
async function getFilePaths(){const filesData={};const inputsToProcess=document.querySelectorAll('#fileUploadSection input[type="file"]');for(const input of inputsToProcess){const id=input.id;if(input.required&&input.files.length===0) throw new Error(`Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø±ÙØ§Ù‚ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: ${document.querySelector(`label[for="${id}"]`).textContent.trim()}`);if(input.files.length===0) continue;filesData[id]=[];for(const f of input.files) filesData[id].push(await fileToDataURL(f));}return filesData;}
document.getElementById('applicationForm').addEventListener('submit',async e=>{e.preventDefault();saveFormState();const msgBox=document.getElementById('message-box');msgBox.style.display='none';const roleKey=document.getElementById('roleSelect').value;if(!roleKey){msgBox.textContent='âŒ ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙˆØ¸ÙŠÙØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.';msgBox.style.backgroundColor='var(--red-emergency)';msgBox.style.display='block';return;}msgBox.textContent='â³ Ø¬Ø§Ø±ÙŠ Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª ÙˆÙ…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø·Ù„Ø¨... Ù‚Ø¯ ÙŠØ³ØªØºØ±Ù‚ Ø§Ù„Ø£Ù…Ø± Ø¨Ø¹Ø¶ Ø§Ù„ÙˆÙ‚Øª.';msgBox.style.backgroundColor='var(--blue-royal)';msgBox.style.display='block';const submitButton=e.target.querySelector('button[type="submit"]');submitButton.disabled=true;let filesData;try{filesData=await getFilePaths();}catch(error){submitButton.disabled=false;msgBox.textContent=`âŒ ${error.message}`;msgBox.style.backgroundColor='var(--red-emergency)';msgBox.style.display='block';return;}const newId=generateApplicationId();const newApplication={id:newId,fullName:document.getElementById('fullName').value.trim(),phoneNumber:document.getElementById('phoneNumber').value.trim(),address:document.getElementById('address').value.trim(),roleKey:roleKey,role:window.ROLES[roleKey].name,files:filesData,status:'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©',submissionTime:new Date().toLocaleString('ar-EG',{timeZone:'Africa/Cairo'})};const data=window.loadData();if(!data[window.KEYS.JOB_APPLICATIONS]) data[window.KEYS.JOB_APPLICATIONS]=[];data[window.KEYS.JOB_APPLICATIONS].push(newApplication);window.saveDataToStorage(window.KEYS.JOB_APPLICATIONS,data[window.KEYS.JOB_APPLICATIONS]);msgBox.innerHTML=`âœ… ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­ØŒ Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨ Ù‡Ùˆ <strong>${newId}</strong>.<br>Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù†Ø³Ø® Ø§Ù„Ø±Ù‚Ù… Ù„Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø¹Ù† Ø­Ø§Ù„Ø© Ø·Ù„Ø¨Ùƒ Ù„Ø§Ø­Ù‚Ø§Ù‹.<br><a href="inquiry.html" class="btn-primary" style="margin-top:10px;">ğŸ” Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø§Ù„Ø¢Ù†</a>`;msgBox.style.backgroundColor='var(--green-success)';msgBox.style.display='block';submitButton.disabled=false;document.getElementById('applicationForm').reset();sessionStorage.clear();toggleFileFields();});
document.addEventListener('DOMContentLoaded',()=>{loadFormState();toggleFileFields();});
</script>
</body>
</html>
